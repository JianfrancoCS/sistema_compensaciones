<div class="validation-preview bg-gray-50 border border-gray-200 rounded-lg p-6">
  <div class="flex items-center justify-between mb-4">
    <h3 class="text-lg font-semibold text-gray-800 flex items-center gap-2">
      <i class="pi pi-eye text-blue-500"></i>
      Vista Previa de Validación
    </h3>
    <p-tag
      [value]="hasValidRegex() ? 'Configurado' : 'Sin configurar'"
      [severity]="hasValidRegex() ? 'success' : 'warning'"
      [rounded]="true"
    ></p-tag>
  </div>

  <!-- Información del regex generado -->
  @if (hasValidRegex()) {
    <div class="mb-6">
    <div class="bg-blue-50 border border-blue-200 rounded-md p-4">
      <div class="flex items-start justify-between">
        <div class="flex-1">
          <div class="flex items-center gap-2 mb-2">
            <i class="pi pi-code text-blue-600"></i>
            <span class="font-medium text-blue-800">Patrón RegEx Generado</span>
          </div>
          <code class="bg-white px-3 py-1 rounded border text-sm font-mono text-gray-800 break-all">
            {{ regex }}
          </code>
        </div>
        <button
          type="button"
          class="text-blue-600 hover:text-blue-800 p-1 ml-2 transition-colors"
          (click)="copyRegexToClipboard()"
          pTooltip="Copiar regex"
          tooltipPosition="left"
        >
          <i class="pi pi-copy"></i>
        </button>
      </div>
    </div>
    </div>
  }

  <!-- Mensaje de error configurado -->
  @if (errorMessage) {
    <div class="mb-6">
      <div class="bg-orange-50 border border-orange-200 rounded-md p-4">
        <div class="flex items-start gap-2">
          <i class="pi pi-exclamation-triangle text-orange-600 mt-1"></i>
          <div>
            <div class="font-medium text-orange-800 mb-1">Mensaje de Error</div>
            <div class="text-orange-700 text-sm">{{ errorMessage }}</div>
          </div>
        </div>
      </div>
    </div>
  }

  <!-- Campo de prueba -->
  @if (hasValidRegex()) {
    <div class="mb-4">
    <div class="mb-3">
      <h4 class="font-medium text-gray-700 mb-2 flex items-center gap-2">
        <i class="pi pi-flask text-purple-500"></i>
        Probar Validación
      </h4>
      <p class="text-sm text-gray-600">
        Ingrese un valor para probar si cumple con las reglas de validación configuradas
      </p>
    </div>

    <div class="relative">
      <p-floatlabel variant="in">
        <input
          pInputText
          id="test_value"
          [(ngModel)]="testValue"
          (input)="onTestValueChange()"
          class="w-full pr-10"
          [class.border-green-300]="testValue && isValid"
          [class.border-red-300]="testValue && !isValid"
        />
        <label for="test_value">Probar {{ variableName }}</label>
      </p-floatlabel>

      <!-- Icono de estado -->
      <div class="absolute right-3 top-1/2 transform -translate-y-1/2">
        <i
          [class]="getValidationStatusIcon()"
          [ngClass]="getValidationStatusClass()"
          pTooltip="{{ getValidationStatusText() }}"
          tooltipPosition="left"
        ></i>
      </div>
    </div>

    <!-- Resultado de la validación -->
    <div class="mt-3">
      @if (!testValue.trim()) {
        <div class="text-sm text-gray-500 flex items-center gap-2">
          <i class="pi pi-info-circle"></i>
          <span>Ingrese un valor para ver el resultado de la validación</span>
        </div>
      }

      @if (testValue.trim() && isValid) {
        <div class="text-sm text-green-600 flex items-center gap-2 bg-green-50 border border-green-200 rounded-md p-3">
          <i class="pi pi-check-circle"></i>
          <span class="font-medium">✓ Valor válido</span>
          <span class="text-green-500">- Cumple con todas las reglas de validación</span>
        </div>
      }

      @if (testValue.trim() && !isValid) {
        <div class="text-sm text-red-600 bg-red-50 border border-red-200 rounded-md p-3">
          <div class="flex items-start gap-2">
            <i class="pi pi-times-circle mt-0.5"></i>
            <div>
              <div class="font-medium mb-1">✗ Valor inválido</div>
              <div class="text-red-500">{{ validationError || 'No cumple con las reglas de validación' }}</div>
            </div>
          </div>
        </div>
      }
    </div>

    <!-- Acciones -->
    @if (testValue) {
      <div class="flex justify-end mt-3">
        <button
          type="button"
          class="text-gray-600 hover:text-gray-800 text-sm flex items-center gap-1 transition-colors"
          (click)="clearTestValue()"
        >
          <i class="pi pi-times"></i>
          Limpiar
        </button>
      </div>
    }
    </div>
  }

  <!-- Estado sin configuración -->
  @if (!hasValidRegex()) {
    <div class="text-center py-8 border border-dashed border-gray-300 rounded-lg">
      <i class="pi pi-cog text-4xl text-gray-400 mb-3"></i>
      <p class="text-gray-600 mb-2">
        No hay validación configurada
      </p>
      <p class="text-sm text-gray-500">
        Configure métodos de validación para ver la vista previa
      </p>
    </div>
  }
</div>
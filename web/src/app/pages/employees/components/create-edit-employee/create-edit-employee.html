<div class="container mx-auto p-4">
  <p-toast></p-toast>

  <div class="flex justify-content-between align-items-center mb-4">
    <h2 class="text-2xl font-bold">{{ isEditMode() ? 'Editar Empleado' : 'Crear Empleado' }}</h2>
    <p-button label="Volver al Listado" icon="pi pi-arrow-left" styleClass="p-button-secondary" (onClick)="goBack(false)"></p-button>
  </div>

  <div *ngIf="isLoading()" class="flex justify-content-center align-items-center">
    <p-progressSpinner></p-progressSpinner>
  </div>

  <div *ngIf="!isLoading()" class="grid justify-content-center">
    <div class="col-12 md:col-6">
      <form [formGroup]="employeeForm" class="p-4 border-round surface-card">

        <!-- Document Number -->
        <div class="field">
          <label for="documentNumber">Número de Documento (DNI)</label>
          <input id="documentNumber" pInputText formControlName="documentNumber" class="w-full" [readOnly]="isEditMode()" />
          <small *ngIf="employeeForm.get('documentNumber')?.touched && employeeForm.get('documentNumber')?.errors?.['required']" class="p-error">El DNI es requerido.</small>
          <small *ngIf="employeeForm.get('documentNumber')?.touched && (employeeForm.get('documentNumber')?.errors?.['minlength'] || employeeForm.get('documentNumber')?.errors?.['maxlength'])" class="p-error">El DNI debe tener 8 dígitos.</small>
        </div>

        <!-- Subsidiary -->
        <div class="field">
          <label for="subsidiary">Sucursal</label>
          <p-select
            id="subsidiary"
            [options]="subsidiaries()"
            formControlName="subsidiaryPublicId"
            optionLabel="name"
            optionValue="publicId"
            placeholder="Seleccione una sucursal"
            styleClass="w-full"
          ></p-select>
          <small *ngIf="employeeForm.get('subsidiaryPublicId')?.touched && employeeForm.get('subsidiaryPublicId')?.errors?.['required']" class="p-error">La sucursal es requerida.</small>
        </div>

        <!-- Position -->
        <div class="field">
          <label for="position">Posición</label>
          <p-select
            id="position"
            [options]="positions()"
            formControlName="positionPublicId"
            optionLabel="name"
            optionValue="publicId"
            placeholder="Seleccione una posición"
            styleClass="w-full"
          ></p-select>
          <small *ngIf="employeeForm.get('positionPublicId')?.touched && employeeForm.get('positionPublicId')?.errors?.['required']" class="p-error">La posición es requerida.</small>
        </div>

        <!-- Save Button -->
        <div class="flex justify-content-end mt-4">
          <p-button label="{{ isEditMode() ? 'Actualizar' : 'Guardar' }}" icon="pi pi-check" (onClick)="saveEmployee()"></p-button>
        </div>
      </form>
    </div>
  </div>
</div>

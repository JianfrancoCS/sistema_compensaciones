<div class="p-4">
  <p-toast></p-toast>

  <div class="mb-4 flex justify-between items-center">
    <div>
      <h1 class="text-2xl font-bold text-gray-700">Gesti√≥n de Roles y Permisos</h1>
      <p class="text-gray-500">Administra los roles y sus permisos</p>
    </div>
    <button
      pButton
      label="Nuevo Rol"
      icon="pi pi-plus"
      class="p-button-primary"
      (click)="openCreateModal()">
    </button>
  </div>

  <div class="bg-white rounded-lg shadow">
    <p-table
      [value]="roleStore.roles()"
      [loading]="roleStore.loading()"
      [paginator]="true"
      [rows]="roleStore.filters().pageSize"
      [totalRecords]="roleStore.totalElements()"
      [lazy]="true"
      styleClass="p-datatable-sm">

      <ng-template pTemplate="header">
        <tr>
          <th>Nombre del Rol</th>
          <th class="text-center">Acciones</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-role>
        <tr>
          <td>{{ role.name }}</td>
          <td class="text-center">
            <button
              pButton
              icon="pi pi-lock"
              class="p-button-sm p-button-text"
              pTooltip="Asignar permisos"
              tooltipPosition="top"
              (click)="openAssignPermissionsModal(role)">
            </button>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="2" class="text-center text-gray-500 py-4">
            No se encontraron roles
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <!-- Create Role Modal -->
  <app-create-role-modal
    [visible]="showCreateModal()"
    (onHide)="closeCreateModal()">
  </app-create-role-modal>

  <!-- Assign Permissions Modal -->
  <app-assign-permissions-modal
    [visible]="showAssignPermissionsModal()"
    [roleId]="selectedRole()?.id || ''"
    [roleName]="selectedRole()?.name || ''"
    (onHide)="closeAssignPermissionsModal()">
  </app-assign-permissions-modal>
</div>